# @core-domain

Ядро доменной логики проекта Kezek.

## Назначение

Пакет предназначен для размещения **чистой бизнес-логики**, независимой от Next.js, Supabase и конкретных транспортов (HTTP, webhooks и т.п.). Здесь должны находиться:

- доменные модели и типы (например, `Booking`, `Branch`, `Staff`, `Service`);
- доменные сервисы/правила (валидация параметров бронирования, расчёт расписания, работа с промо, финансы);
- интерфейсы репозиториев и внешних портов (доступ к БД, отправка уведомлений и т.д.).

Инфраструктурные детали (Supabase, RPC, HTTP-запросы, Next API routes) должны жить в `apps/*` и реализовывать интерфейсы из `@core-domain`.

## Принципы

- **Без фреймворков**: никакой зависимости от Next.js/React/Expo.
- **Без прямых обращений к Supabase клиенту**: только абстракции репозиториев.
- **Чистые функции и сервисы**: максимум логики, которую можно тестировать без БД и сети.

## Структура (план)

По мере реализации задач из `IMPROVEMENT_TASKS.md` планируется следующая структура:

- `src/booking` — доменная логика бронирований (создание, hold/confirm/cancel, инварианты);
- `src/schedule` — расчёт слотов, работа с `working_hours`, проверка пересечений;
- `src/promotions` — применение промо-акций, ограничения и проверки;
- `src/finance` — базовые правила по финансовым операциям/агрегациям;
- `src/ports` — интерфейсы репозиториев и внешних сервисов;
- `src/index.ts` — публичный API пакета.

## Скрипты

```bash
pnpm -C packages/core-domain typecheck
```

Проверяет типы без эмита кода.

