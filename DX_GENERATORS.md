# Генераторы для новых фич (DX-1)

Этот файл описывает, как пользоваться простыми генераторами/шаблонами для ускорения разработки.

## 1. Генератор API-роутов

Скрипт: `scripts/generate-api-route.mjs`  
Команда (из корня репозитория):

```bash
pnpm generate:api-route bookings/cancel
```

Что сделает команда:

- создаст (если ещё не существуют):
  - `apps/web/src/app/api/bookings/cancel/route.ts`
  - `apps/web/src/__tests__/api/bookings/cancel/route.test.ts`
- проставит базовую обёртку `withErrorHandler` + `withRateLimit` и скелет `@swagger`‑блока;
- создаст простой Jest‑тест со скелетом (проверка успешного ответа).

Дальше разработчик:

1. Дописывает бизнес‑логику в `route.ts` (валидация, use‑case, репозитории).
2. Расширяет тест `route.test.ts` по паттернам из `apps/web/src/__tests__/api/TESTING_GUIDE.md`.
3. При необходимости уточняет swagger‑описание прямо в JSDoc.

## 2. Шаблоны для страниц и use-case (рекомендация)

Для страниц и доменных use-case пока нет автоматического генератора, но есть рекомендуемые паттерны:

- **Новая страница/экран (Next App Router):**
  - создайте директорию `apps/web/src/app/<path>/` и файл `page.tsx`;
  - используйте готовые примеры из существующих страниц (`b/[slug]/booking/page.tsx`, `dashboard/...`);
  - для E2E — добавьте сценарий в `apps/web/e2e/*.spec.ts` по аналогии с существующими.

- **Новый доменный use-case:**
  - для бронирований/промо — добавляйте функции в `packages/core-domain/src/booking/useCases.ts`;
  - для расписаний — в `packages/core-domain/src/schedule/*`;
  - для других доменов — заведите соответствующий модуль в `core-domain` и экспортируйте через `src/index.ts`.

При желании этот же подход можно позже автоматизировать (добавить новые подкоманды к генератору), но базовый DX‑профит уже даёт генерация API‑шаблонов и тестов под них.

