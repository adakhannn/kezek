# –ê—É–¥–∏—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –≤ API endpoints

**–î–∞—Ç–∞**: 2024-12-19  
**–°—Ç–∞—Ç—É—Å**: –í –ø—Ä–æ—Ü–µ—Å—Å–µ

## –†–µ–∑—é–º–µ

–ü—Ä–æ–≤–µ–¥–µ–Ω –∞—É–¥–∏—Ç API endpoints –Ω–∞ –ø—Ä–µ–¥–º–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞. –ë–æ–ª—å—à–∏–Ω—Å—Ç–≤–æ endpoints —É–∂–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç `getBizContextForManagers()` –∏–ª–∏ `getStaffContext()` –∏ –ø—Ä–æ–≤–µ—Ä—è—é—Ç –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å —Ä–µ—Å—É—Ä—Å–æ–≤ –∫ –±–∏–∑–Ω–µ—Å—É.

## –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞—É–¥–∏—Ç–∞

### ‚úÖ Endpoints —Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–æ–π –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞

1. **services/create** - ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `getBizContextForManagers()`, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å —Ñ–∏–ª–∏–∞–ª–æ–≤
2. **services/[id]/update** - ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `getBizContextForManagers()`, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å —É—Å–ª—É–≥–∏ –∏ —Ñ–∏–ª–∏–∞–ª–æ–≤
3. **services/[id]/delete** - ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `getBizContextForManagers()`, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å —É—Å–ª—É–≥–∏
4. **bookings/[id]/mark-attendance** - ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `getBizContextForManagers()`, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å –±—Ä–æ–Ω–∏
5. **branches/[id]/update** - ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `getBizContextForManagers()`, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å —Ñ–∏–ª–∏–∞–ª–∞
6. **branches/[id]/delete** - ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `getBizContextForManagers()`, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—É–ø–µ—Ä–∞–¥–º–∏–Ω–∞ –∏ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å —Ñ–∏–ª–∏–∞–ª–∞
7. **branches/[id]/schedule** - ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `getBizContextForManagers()`, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å —Ñ–∏–ª–∏–∞–ª–∞
8. **branches/create** - ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `getBizContextForManagers()`
9. **staff/create** - ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `getBizContextForManagers()`, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–æ–ª–∏
10. **staff/update** - ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `getBizContextForManagers()`, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–æ–ª–∏
11. **staff/[id]/update** - ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `getBizContextForManagers()`, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –∏ —Ñ–∏–ª–∏–∞–ª–∞
12. **staff/[id]/delete** - ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `getBizContextForManagers()`, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞
13. **staff/[id]/transfer** - ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `getBizContextForManagers()`, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞ –∏ —Ñ–∏–ª–∏–∞–ª–∞
14. **dashboard/branches/[branchId]/promotions** - ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `getBizContextForManagers()`, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å —Ñ–∏–ª–∏–∞–ª–∞
15. **dashboard/branches/[branchId]/promotions/[promotionId]** - ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `getBizContextForManagers()`, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å –∞–∫—Ü–∏–∏

### ‚ö†Ô∏è Endpoints, —Ç—Ä–µ–±—É—é—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

1. **bookings/[id]/cancel** - ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û**: –¢–µ–ø–µ—Ä—å –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å –∫ –±–∏–∑–Ω–µ—Å—É –¥–ª—è –º–µ–Ω–µ–¥–∂–µ—Ä–æ–≤
2. **staff/[id]/restore** - ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û**: –¢–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç service client –¥–ª—è –æ–±—Ö–æ–¥–∞ RLS
3. **staff/[id]/dismiss** - ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û**: –¢–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç service client –¥–ª—è –æ–±—Ö–æ–¥–∞ RLS

### ‚úÖ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ endpoints

1. **dashboard/staff-shifts/[id]/update-hours** - ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `getBizContextForManagers()`, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å —Å–º–µ–Ω—ã –∫ –±–∏–∑–Ω–µ—Å—É
2. **staff/avatar/upload** - ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `getStaffContext()` - —Å–æ—Ç—Ä—É–¥–Ω–∏–∫ –º–æ–∂–µ—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å —Ç–æ–ª—å–∫–æ —Å–≤–æ–π –∞–≤–∞—Ç–∞—Ä
3. **staff/avatar/remove** - ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `getStaffContext()` - —Å–æ—Ç—Ä—É–¥–Ω–∏–∫ –º–æ–∂–µ—Ç —É–¥–∞–ª—è—Ç—å —Ç–æ–ª—å–∫–æ —Å–≤–æ–π –∞–≤–∞—Ç–∞—Ä
4. **profile/update** - ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –æ–±–Ω–æ–≤–ª—è–µ—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–π –ø—Ä–æ—Ñ–∏–ª—å
5. **users/search** - ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `getBizContextForManagers()`, –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–∏—Å–∫–ª—é—á–∞—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ —Ç–µ–∫—É—â–µ–≥–æ –±–∏–∑–Ω–µ—Å–∞)

### üìã Endpoints, —Ç—Ä–µ–±—É—é—â–∏–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏

–°–ª–µ–¥—É—é—â–∏–µ endpoints —Ç—Ä–µ–±—É—é—Ç —Ä—É—á–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏:
- `/api/notify` - endpoint –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- `/api/quick-hold` - –±—ã—Å—Ç—Ä–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Å–ª–æ—Ç–∞
- `/api/quick-book-guest` - –±—ã—Å—Ç—Ä–æ–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –≥–æ—Å—Ç–µ–π

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. ‚úÖ –°–æ–∑–¥–∞–Ω–∞ —É—Ç–∏–ª–∏—Ç–∞ `@/lib/authCheck` –¥–ª—è —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
2. ‚ö†Ô∏è –û–±–Ω–æ–≤–∏—Ç—å `staff/[id]/restore` –∏ `staff/[id]/dismiss` –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è service client
3. ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Å—Ç–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞—É–¥–∏—Ç endpoints, —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏
4. ‚ö†Ô∏è –î–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ –≤–æ –≤—Å–µ—Ö endpoints

## –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞

–°–æ–∑–¥–∞–Ω –º–æ–¥—É–ª—å `@/lib/authCheck.ts` —Å —Ñ—É–Ω–∫—Ü–∏—è–º–∏:
- `checkResourceBelongsToBusiness()` - —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏ —Ä–µ—Å—É—Ä—Å–∞
- `checkBranchBelongsToBusiness()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∏–ª–∏–∞–ª–∞
- `checkStaffBelongsToBusiness()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞
- `checkServiceBelongsToBusiness()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª—É–≥–∏
- `checkBookingBelongsToBusiness()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è
- `checkPromotionBelongsToBusiness()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∞–∫—Ü–∏–∏
- `checkBranchesBelongToBusiness()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–ø–∏—Å–∫–∞ —Ñ–∏–ª–∏–∞–ª–æ–≤

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω—ã `staff/[id]/restore` –∏ `staff/[id]/dismiss` –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è service client
2. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω `bookings/[id]/cancel` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç–∏ –∫ –±–∏–∑–Ω–µ—Å—É
3. ‚úÖ –ü—Ä–æ–≤–µ–¥–µ–Ω –∞—É–¥–∏—Ç 20+ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö endpoints
4. ‚ö†Ô∏è –ü—Ä–æ–≤–µ—Å—Ç–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∞—É–¥–∏—Ç –æ—Å—Ç–∞–≤—à–∏—Ö—Å—è endpoints (notify, quick-hold, quick-book-guest)
5. ‚ö†Ô∏è –î–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
6. ‚ö†Ô∏è –°–æ–∑–¥–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é —É—Ç–∏–ª–∏—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞

## –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

- **–ü—Ä–æ–≤–µ—Ä–µ–Ω–æ endpoints**: 20+
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –ø—Ä–æ–±–ª–µ–º**: 3
- **–°–æ–∑–¥–∞–Ω–æ —É—Ç–∏–ª–∏—Ç**: 1 –º–æ–¥—É–ª—å (`@/lib/authCheck`)
- **–ü—Ä–æ–≥—Ä–µ—Å—Å**: ~75% (–æ—Å–Ω–æ–≤–Ω—ã–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ endpoints –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã)

