# Базовый набор smoke-тестов для mobile приложения

Этот документ описывает минимальный набор тестов, который должен проходить перед каждым релизом mobile приложения.

## Обязательные тесты перед релизом

### 1. Auth экраны

Все экраны авторизации должны рендериться без ошибок:

- ✅ `SignInScreen.test.tsx` — экран входа
- ✅ `SignUpScreen.test.tsx` — экран регистрации
- ✅ `VerifyScreen.test.tsx` — экран подтверждения
- ✅ `WhatsAppScreen.test.tsx` — экран WhatsApp авторизации

**Команда для запуска:**
```bash
pnpm test src/__tests__/screens/auth/
```

### 2. Основные экраны

Ключевые экраны приложения должны рендериться без ошибок:

- ✅ `StaffScreen.test.tsx` — экран списка смен сотрудника
- ✅ `CabinetScreen.test.tsx` — экран кабинета клиента со списком бронирований
- ✅ `BookingDetailsScreen.test.tsx` — экран деталей бронирования

**Команда для запуска:**
```bash
pnpm test src/__tests__/screens/
```

### 3. Навигация

Навигация между шагами бронирования должна работать:

- ✅ `BookingNavigation.test.tsx` — проверка навигации между шагами бронирования:
  - BookingStep1Branch (выбор филиала)
  - BookingStep2Service (выбор услуги)
  - BookingStep3Staff (выбор мастера)
  - BookingStep4Date (выбор даты)
  - BookingStep5Time (выбор времени)
  - BookingStep6Confirm (подтверждение)

**Команда для запуска:**
```bash
pnpm test src/__tests__/navigation/
```

## Запуск всех smoke-тестов

```bash
# Запустить все тесты
pnpm test

# Запустить с покрытием
pnpm test:coverage

# Запустить в watch режиме
pnpm test:watch
```

## Критерии успешного прохождения

Все тесты должны:
1. ✅ Рендериться без ошибок (не падать при монтировании компонента)
2. ✅ Отображать основные элементы интерфейса (поля ввода, кнопки)
3. ✅ Корректно обрабатывать навигацию между экранами

## Добавление новых тестов

**При добавлении нового экрана в приложение обязательно добавьте соответствующий smoke-тест** (по аналогии с SignInScreen, WhatsAppScreen и т.д.). В репозитории включено правило (`.cursor/rules/mobile-smoke-tests.mdc`) для напоминания при работе с экранами.

1. Создайте файл теста в `src/__tests__/screens/` (для auth — в `src/__tests__/screens/auth/`), например `NewScreen.test.tsx`.
2. Используйте тот же подход: мок навигации, `render(<NewScreen />)`, проверка наличия ключевого элемента (текст, placeholder, кнопка).
3. Запустите тест: `pnpm test src/__tests__/screens/` — убедитесь, что он проходит.
4. Добавьте пункт в соответствующий список выше (Auth экраны или Основные экраны).

## Регрессия на реальных устройствах (перед крупным релизом)

Перед крупным релизом (мажорная/минорная версия, выход в сторе) рекомендуется проверить ключевые сценарии **на реальных устройствах** (iOS и Android), а не только в симуляторе/эмуляторе.

### Чеклист

- [ ] **iOS** — хотя бы одно физическое устройство или актуальный симулятор:
  - Вход / регистрация (email OTP или WhatsApp, при наличии).
  - Открытие и закрытие смены (роль сотрудника).
  - Проход бронирования: филиал → услуга → мастер → дата → время → подтверждение.
  - Кабинет клиента: список бронирований, открытие деталей брони.
- [ ] **Android** — то же самое на реальном устройстве или эмуляторе с актуальной версией ОС.

Результат проверки можно кратко зафиксировать в релизных заметках или в тикете релиза. См. также `CONTRIBUTING.md`, раздел про mobile и чеклист перед PR.

## CI/CD

Все smoke-тесты автоматически запускаются в CI pipeline перед релизом mobile приложения.

